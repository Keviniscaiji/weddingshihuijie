<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <title>婚姻系统正式上线 - 祝新婚快乐</title>
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        /* 切换为更有质感的红丝绒渐变 */
        background: radial-gradient(
          circle at center,
          #8b0000 0%,
          #4a0000 70%,
          #200000 100%
        );
        overflow: hidden;
        font-family:
          "Microsoft YaHei", ui-monospace, Menlo, Monaco, Consolas, monospace;
      }
      canvas {
        position: fixed;
        inset: 0;
        z-index: 1;
      }
      .panel {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
        z-index: 10;
      }
      .terminal {
        width: min(920px, 92vw);
        /* 深红半透明质感 */
        background: rgba(45, 5, 5, 0.85);
        border-radius: 18px;
        padding: 24px;
        /* 金色光晕边框 */
        box-shadow:
          0 10px 50px rgba(255, 215, 0, 0.2),
          0 0 30px rgba(255, 60, 0, 0.1);
        border: 2px solid rgba(255, 215, 0, 0.4);
        backdrop-filter: blur(12px);
      }
      .header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
        border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        padding-bottom: 10px;
      }
      .dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }
      /* 状态灯改为明亮的金红配色 */
      .red {
        background: #ff4d4d;
        box-shadow: 0 0 10px #ff4d4d;
      }
      .yellow {
        background: #ffd700;
        box-shadow: 0 0 10px #ffd700;
      }
      .green {
        background: #32cd32;
        box-shadow: 0 0 10px #32cd32;
      }

      .title {
        margin-left: 8px;
        font-size: 14px;
        color: #ffd700;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 8px;
        letter-spacing: 1px;
      }
      .output {
        white-space: pre-wrap;
        font-size: clamp(16px, 2vw, 20px);
        line-height: 1.8;
        /* 金粉质感文字 */
        color: #fff2cc;
        text-shadow: 0 0 8px rgba(255, 215, 0, 0.4);
        min-height: 300px;
      }
      .cursor {
        display: inline-block;
        width: 12px;
        height: 1.2em;
        background: #ffd700;
        margin-left: 4px;
        animation: blink 1s infinite;
        box-shadow: 0 0 12px rgba(255, 215, 0, 0.8);
        vertical-align: middle;
      }
      @keyframes blink {
        50% {
          opacity: 0;
        }
      }

      .footer {
        margin-top: 15px;
        font-size: 13px;
        color: rgba(255, 215, 0, 0.6);
        display: flex;
        justify-content: center;
      }
      /* 增加背景大“囍”字感 */
      .bg-xi {
        position: fixed;
        font-size: 60vh;
        color: rgba(255, 0, 0, 0.05);
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 0;
        user-select: none;
      }
    </style>
  </head>

  <body>
    <div class="bg-xi">囍</div>
    <canvas id="bg"></canvas>

    <div class="panel">
      <div class="terminal">
        <div class="header">
          <div class="dot red"></div>
          <div class="dot yellow"></div>
          <div class="dot green"></div>
          <div class="title">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path
                d="M12 21s-7.5-4.7-9.2-8.1C1.9 9.7 6.1 5 12 9.1 17.9 5 22.1 9.7 21.2 12.9 19.5 16.3 12 21 12 21z"
                fill="#ffd700"
              />
            </svg>
            LOVE-OS v2.14: 婚姻系统初始化控制台
          </div>
        </div>
        <div class="output" id="out"></div>
        <span class="cursor"></span>
        <div class="footer">
          <div id="state">正在同步幸福频率...</div>
        </div>
      </div>
    </div>

    <script>
      const out = document.getElementById("out");
      const stateBox = document.getElementById("state");

      // 稍微优化了文案，增加仪式感
      const script = [
        "> 加载核心情感模块... [OK]",
        "> 建立双人独占连接... [Connected]",
        "> 检测到生命中的另一半，正在同步运行频率...",
        "",
        "在这个特别的日子里，",
        "愿你们：",
        "在共享的岁月里领略晨昏与四季，",
        "成为彼此生命中最坚实的避风港。",
        "有着共同奔赴的远方，亦有彼此包容的温柔。",
        "",
        "婚姻美满，白头偕老。",
        "祝新婚愉快！",
        "",
        "—— From 凯文",
      ];

      let line = 0;
      let char = 0;
      let buffer = "";

      function typeNext() {
        if (line >= script.length) {
          stateBox.textContent = "系统状态：幸福永续运行中";
          stateBox.style.color = "#ffd700";
          return;
        }
        const current = script[line];
        if (char < current.length) {
          buffer += current[char];
          char++;
        } else {
          buffer += "\n";
          line++;
          char = 0;
        }
        out.textContent = buffer;
        // 打字速度稍微加快，更有科技感
        setTimeout(typeNext, 150);
      }

      setTimeout(typeNext, 1000); // 延迟1秒开始，增加加载感

      /* 特效系统：金粉、囍字与礼花 */
      const canvas = document.getElementById("bg");
      const ctx = canvas.getContext("2d");
      function resize() {
        canvas.width = innerWidth;
        canvas.height = innerHeight;
      }
      window.addEventListener("resize", resize);
      resize();

      const particles = [];
      const festiveColors = [
        "#FFD700",
        "#FFA500",
        "#FF4500",
        "#FF0000",
        "#FFFACD",
      ];

      function createParticle(x, y, color, isXi = false) {
        const count = isXi ? 10 : 30;
        for (let i = 0; i < count; i++) {
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 5 + 2;
          particles.push({
            x,
            y,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            life: Math.random() * 60 + 40,
            age: 0,
            color,
            size: isXi ? Math.random() * 15 + 10 : Math.random() * 3 + 1,
            gravity: 0.1,
            isXi: isXi,
          });
        }
      }

      function spawnCelebration() {
        // 随机在空中绽放金色礼花
        if (Math.random() < 0.04) {
          createParticle(
            Math.random() * canvas.width,
            Math.random() * canvas.height * 0.6,
            festiveColors[Math.floor(Math.random() * festiveColors.length)],
            Math.random() > 0.8, // 20% 几率炸出囍字
          );
        }
      }

      // 彩纸纸屑
      const confetti = Array.from({ length: 80 }, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        w: Math.random() * 6 + 4,
        h: Math.random() * 8 + 4,
        v: Math.random() * 1.2 + 0.5,
        rot: Math.random() * Math.PI * 2,
        vr: (Math.random() - 0.5) * 0.1,
        color: festiveColors[Math.floor(Math.random() * festiveColors.length)],
      }));

      function draw() {
        // 增加尾迹透明度，让画面更干净
        ctx.fillStyle = "rgba(40, 0, 0, 0.15)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // 绘制持续下落的金箔
        confetti.forEach((p) => {
          p.y += p.v;
          p.rot += p.vr;
          if (p.y > canvas.height) p.y = -20;
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
          ctx.restore();
        });

        spawnCelebration();

        // 绘制爆炸粒子
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.vy += p.gravity;
          p.age++;
          const alpha = 1 - p.age / p.life;
          ctx.globalAlpha = alpha;

          if (p.isXi) {
            ctx.fillStyle = "#ffd700";
            ctx.font = `${p.size}px serif`;
            ctx.fillText("囍", p.x, p.y);
          } else {
            ctx.fillStyle = p.color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
            ctx.fill();
          }

          if (p.age >= p.life) particles.splice(i, 1);
        }
        ctx.globalAlpha = 1;
        requestAnimationFrame(draw);
      }
      draw();
    </script>
  </body>
</html>
