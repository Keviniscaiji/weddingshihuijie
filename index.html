<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <title>婚姻系统正式上线</title>
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        /* 更加深邃喜庆的红黑渐变 */
        background: linear-gradient(180deg, #4a0000 0%, #120007 60%);
        overflow: hidden;
        font-family: ui-monospace, Menlo, Monaco, Consolas, monospace;
      }
      canvas {
        position: fixed;
        inset: 0;
        z-index: 1;
      }
      .panel {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
        z-index: 10;
      }
      .terminal {
        width: min(920px, 92vw);
        background: linear-gradient(
          180deg,
          rgba(60, 6, 6, 0.8),
          rgba(20, 4, 4, 0.7)
        );
        border-radius: 18px;
        padding: 24px;
        /* 金色光晕 */
        box-shadow:
          0 10px 50px rgba(255, 200, 80, 0.2),
          0 0 30px rgba(255, 120, 60, 0.1);
        border: 1px solid rgba(255, 200, 80, 0.3);
        backdrop-filter: blur(8px);
      }
      .header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 14px;
      }
      .dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
      }
      .red {
        background: #ff5a5a;
        box-shadow: 0 0 8px #ff5a5a;
      }
      .yellow {
        background: #ffd166;
        box-shadow: 0 0 8px #ffd166;
      }
      .green {
        background: #7affc6;
        box-shadow: 0 0 8px #7affc6;
      }

      .title {
        margin-left: 8px;
        font-size: 13px;
        color: #ffd166;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .output {
        white-space: pre-wrap;
        font-size: clamp(14px, 1.8vw, 18px);
        line-height: 1.6;
        color: rgba(255, 245, 230, 0.98);
        text-shadow: 0 0 12px rgba(255, 200, 80, 0.1);
        min-height: 280px;
      }
      .cursor {
        display: inline-block;
        width: 10px;
        height: 1.1em;
        background: #ffd166;
        margin-left: 2px;
        animation: blink 1s infinite;
        box-shadow: 0 0 8px rgba(255, 180, 60, 0.8);
        vertical-align: middle;
      }
      @keyframes blink {
        50% {
          opacity: 0;
        }
      }

      .footer {
        margin-top: 10px;
        font-size: 12px;
        color: rgba(255, 220, 160, 0.85);
        display: flex;
        justify-content: center; /* 改为居中，仅显示状态 */
      }
    </style>
  </head>

  <body>
    <canvas id="bg"></canvas>

    <div class="panel">
      <div class="terminal">
        <div class="header">
          <div class="dot red"></div>
          <div class="dot yellow"></div>
          <div class="dot green"></div>
          <div class="title">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path
                d="M12 21s-7.5-4.7-9.2-8.1C1.9 9.7 6.1 5 12 9.1 17.9 5 22.1 9.7 21.2 12.9 19.5 16.3 12 21 12 21z"
                fill="#ffd166"
              />
            </svg>
            婚姻系统控制台
          </div>
        </div>
        <div class="output" id="out"></div>
        <span class="cursor"></span>
        <div class="footer">
          <div id="state">运行中</div>
        </div>
      </div>
    </div>

    <script>
      const out = document.getElementById("out");
      const stateBox = document.getElementById("state");

      // 严格保留原版文案
      const script = [
        "系统初始化中...",
        "核心模块加载完毕。",
        "正在建立新婚连接...",
        "在这个特别的日子里，",
        "愿你们：",
        "在两人一起的的日子里共享晨昏与四季，",
        "成为彼此最可靠的支撑。",
        "有着共同的远方，同时又彼此包容理解",
        "婚姻美满 幸福长久",
        "祝新婚愉快。",
        "From 凯文",
        "",
      ];
      let line = 0;
      let char = 0;
      let buffer = "";

      function typeNext() {
        if (line >= script.length) {
          stateBox.textContent = "已完成";
          return;
        }
        const current = script[line];
        if (char < current.length) {
          buffer += current[char];
          char++;
        } else {
          buffer += "\n";
          line++;
          char = 0;
        }
        out.textContent = buffer;
        setTimeout(typeNext, 180);
      }

      typeNext();

      /* 特效系统 — 烟花与鞭炮碎屑 */
      const canvas = document.getElementById("bg");
      const ctx = canvas.getContext("2d");
      function resize() {
        canvas.width = innerWidth;
        canvas.height = innerHeight;
      }
      window.addEventListener("resize", resize);
      resize();

      const particles = [];
      const festiveColors = [
        "#ff4d6d",
        "#ffd166",
        "#ffb86b",
        "#7affc6",
        "#d90000",
        "#ffeb3b",
      ];

      function createParticle(x, y, color, isFirecracker = false) {
        const count = isFirecracker ? 20 : 40;
        for (let i = 0; i < count; i++) {
          const angle = Math.random() * Math.PI * 2;
          const speed = isFirecracker
            ? Math.random() * 6 + 2
            : Math.random() * 4 + 1;
          particles.push({
            x,
            y,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            life: Math.random() * 50 + 30,
            age: 0,
            color,
            size: Math.random() * 3 + 1,
            gravity: isFirecracker ? 0.2 : 0.05,
          });
        }
      }

      function spawnCelebration() {
        // 随机在空中放烟花
        if (Math.random() < 0.03) {
          createParticle(
            Math.random() * canvas.width,
            Math.random() * canvas.height * 0.5,
            festiveColors[Math.floor(Math.random() * festiveColors.length)],
          );
        }
        // 随机在底部放“鞭炮”
        if (Math.random() < 0.02) {
          createParticle(
            Math.random() * canvas.width,
            canvas.height - 20,
            "#d90000", // 鞭炮红
            true,
          );
        }
      }

      const confetti = Array.from({ length: 100 }, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        w: Math.random() * 8 + 4,
        h: Math.random() * 10 + 6,
        v: Math.random() * 1.5 + 0.5,
        rot: Math.random() * Math.PI * 2,
        vr: (Math.random() - 0.5) * 0.1,
        color: festiveColors[Math.floor(Math.random() * festiveColors.length)],
      }));

      function draw() {
        ctx.fillStyle = "rgba(18, 4, 4, 0.2)"; // 尾迹感
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // 绘制持续下落的彩纸
        confetti.forEach((p) => {
          p.y += p.v;
          p.rot += p.vr;
          if (p.y > canvas.height) p.y = -20;
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
          ctx.restore();
        });

        spawnCelebration();

        // 绘制爆炸粒子
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.vy += p.gravity;
          p.age++;
          const alpha = 1 - p.age / p.life;
          ctx.globalAlpha = alpha;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fill();
          if (p.age >= p.life) particles.splice(i, 1);
        }
        ctx.globalAlpha = 1;
        requestAnimationFrame(draw);
      }
      draw();
    </script>
  </body>
</html>
